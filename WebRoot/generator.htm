
<!DOCTYPE HTML>
<!-- <html manifest="generator.manifest">  -->
<html>
	<head>
    	<meta name="viewport" content="width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Highcharts Example</title>
  		<script type="text/javascript" src="./support/jquery-1.11.2.min.js"></script>
  		
         <script type="text/javascript" src="./support/bootstrap/js/bootstrap.min.js"></script>    
        <link href="./support/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
		<script type="text/javascript" src="./support/easyui/jquery.easyui.min.js"></script>  
        
		<script type="text/javascript" src="./support/datatable/media/js/jquery.dataTables.min.js"></script> 
        <link rel="stylesheet" type="text/css" href="./support/datatable/media/css/jquery.dataTables.min.css"/>
        <!--日期选择框-->
		<script src="./support/datepicker/js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css" />
        <link href="./support/datepicker/css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css" />
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css" />        

		<link href="./support/threeMainPage.css" rel="stylesheet" type="text/css" />
		<script src="./support/jquery.json.min.js" type="text/javascript"></script>
		
		<script type="text/javascript">
			var g1Chart;
			var g1Option;
			var g2Chart;
			var g2Option;
			var ajaxbg;						
			var columnOption = null;
		
		$(function () {
       columnOption ={
            chart: {
                type: 'column',
                renderTo: 'columnContainer'
            },
            title: {
                text: '值间月度负荷率对比'
            },
            subtitle: {
                text: ''
            },
            exporting:{
				enabled:false
			},
			credits:{
				enabled:'false',
				text:''
			},
            xAxis: {
                type: 'category',
                labels: {
                    rotation: -45,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: null
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                //pointFormat: '月度发电量<b>{point.y:.1f} (万千瓦时)</b>',
                formatter:function(){
					var month = $("#appDate").val().substr(5,2);
					var s = this.series.data[this.x].name+month+'月份';
					s += '<br/>'+this.y+'%';
					return s;
				}
            },
            series: [{
                name: 'Population',
//                 data: [
//                     ['Shanghai', 23.7],
//                     ['Lagos', 16,1],
//                     ['Instanbul', 14.2],
//                     ['Karachi', 14.0],
//                     ['Mumbai', 12.5],
//                     ['Moscow', 12.1],
//                     ['São Paulo', 11.8],
//                     ['Beijing', 11.7],
//                     ['Guangzhou', 11.1],
//                     ['Delhi', 11.1],
//                     ['Shenzhen', 10.5],
//                     ['Seoul', 10.4],
//                     ['Jakarta', 10.0],
//                     ['Kinshasa', 9.3],
//                     ['Tianjin', 9.3],
//                     ['Tokyo', 9.0],
//                     ['Cairo', 8.9],
//                     ['Dhaka', 8.9],
//                     ['Mexico City', 8.9],
//                     ['Lima', 8.9]
//                 ],
                dataLabels: {
                    enabled: true,
                    rotation: -90,
                    color: '#FFFFFF',
                    align: 'right',
                    x: 4,
                    y: 10,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif',
                        textShadow: '0 0 3px black'
                    }
                }
            }]
        };
        chart = new Highcharts.Chart(columnOption);
    });
		
		
			
			$(function () {
					
			    var gaugeOptions = {
				
				    chart: {
				        type: 'solidgauge'
				    },
				    
				    title: null,
				    
				    pane: {
				    	center: ['50%', '85%'],
				    	size: '130%',//中间表盘与pane的大小对比，数值越大，表盘就越大
				        startAngle: -90,
				        endAngle: 90,
			            background: {
			                backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
			                innerRadius: '60%',
			                outerRadius: '100%',
			                shape: 'arc'
			            }
				    },
			
				    tooltip: {
				    	enabled: false
				    },
				    credits:{
						enabled:'false',
						text:''
					}, 
				    // the value axis
				    yAxis: {
						stops: [
							[0.1, '#55BF3B'], // green
				        	[0.5, '#DDDF0D'], // yellow
				        	[0.9, '#DF5353'] // red
						],
						lineWidth: 0,
			            minorTickInterval: null,
			            tickPixelInterval: 400,
			            tickWidth: 0,
				        title: {
			                y: -40//标题的位置
				        },
			            labels: {
			                y: 10//表盘刻度位置
			
			            }   
				    },
			        
			        plotOptions: {
			            solidgauge: {
			                dataLabels: {
			                    y: 5,
			                    borderWidth: 0,
			                    useHTML: true
			                }
			            }
			        }
			    };
			    
			    // The speed gauge
			
			    
				//generator1对应的表盘的option
				g1Option = Highcharts.merge(gaugeOptions, {
					chart:{
				    	renderTo: 'g1Container'
				    },
			        yAxis: {
				        min: 0,
				        max: 100,
				        title: {
				            text: '#1机'
				        }       
				    },
			
				    credits: {
				    	enabled: false
				    },
				
				    series: [{
				        name: 'rate',
				        data: [0],
				        dataLabels: {
				        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
			                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'gray') + '">{y}</span>' + 
			                   	'<span style="font-size:10px;color:gray">%</span></div>'
				        },
				        tooltip: {
				            valueSuffix: ' km/h'
				        }
				    }]
				
				});//g2Option
			
			
				//generator2对应的表盘的option
				g2Option = Highcharts.merge
				(gaugeOptions, 
				    {
				    	chart:{
				    		renderTo: 'g2Container'
				    	},
				        yAxis:{
				        	min: 0,
				        	max: 100,
					        title:{
					            text: '#2机'
					        },    
					    },
					
					    series:[{
						        name: 'rate',
						        data: [0],
						        dataLabels:{
						        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
					                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'gray') + '">{y}</span>' + 
					                   	'<span style="font-size:10px;color:gray">%</span></div>'
						        },
						        tooltip:{
						            valueSuffix: ' revolutions/min'
						        }      
						    }
					    ]
					
					}
				);//g1Option			
			});//function
    
    submitRequest = function()
    {
    	var date = $("#appDate").val().trim();
    	var time_span = $("#menu_title").text().trim();
    	$.ajax({
    		url:"/pimsPhone/GeneratorServlet",
    		data:$.param({"date":date}),
    		type:"post",
    		beforeSend:function(){
//     			ajaxbg.show(); 
    		}

    	})
    	.done(function(data,statusText){

			ajaxbg.hide();
    		var dataReceived = $.evalJSON(data);
    		
    		columnOption.series[0].data=dataReceived.monthLoadRate;
     		chart = new Highcharts.Chart(columnOption);

    		$("#average_power").text(dataReceived.average);
    		$("#energy").text(dataReceived.energy);
    		$("#timeUse").text(dataReceived.timeUse);
    		$("#volume").text(GENERATORVOLUME*2);
    		
    		$("#g1Volume").text(GENERATORVOLUME);
    		$("#g1Energy").text(dataReceived.g1Energy);
    		$("#g1Average").text(dataReceived.g1Average);
    		$("#g1TimeUse").text(dataReceived.g1TimeUse);
    		
    		$("#g2Volume").text(GENERATORVOLUME);
    		$("#g2Energy").text(dataReceived.g2Energy);
    		$("#g2Average").text(dataReceived.g2Average);
    		$("#g2TimeUse").text(dataReceived.g2TimeUse);
    		
    		g1Option.series[0].data[0] = parseFloat((dataReceived.g1Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g1Option);
    		
    		g2Option.series[0].data[0] = parseFloat((dataReceived.g2Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g2Option);
    	})
    	.fail(function(){
    		alert("服务器响应出错");
    	});
    };


	$(document).ready(function() {
	
		//$('#table_id1').DataTable();
		if($("table").length > 0)
		{
			$("table").dataTable({
				paging:false,
				searching:false,
				info:false,
				ordering: false,
			});
		}
	
	
	});
	</script>
	
	<script type="text/javascript" src="./support/threeMainPage.js"></script>
	</head>
	<body>
<script src="./support/highcharts/js/highcharts.js"></script>
<script src="./support/highcharts/js/highcharts-more.js"></script>

<script src="./support/highcharts/js/modules/solid-gauge.js"></script> 
<script src="./support/ace/assets/js/spin.min.js"></script> 	



<div id="background" class="background" style="display: none; min-height: 100%;_height:100%;"></div> 
<div id="progressBar" class="progressBar" style="display: none;font-size: 12px;">数据加载中，请稍等...</div> 
<!--时间选择器-->
<div style="clear:both;height:10px"></div>
	<div style="margin-left:20px;margin-right:20px">
		<div style=";float:left">	
	        <label for="test_default" style="float:left;;width:80px">日&nbsp;&nbsp;&nbsp;&nbsp;期</label>
	        <input type="text" name="test_default" id="appDate" style="width:100px;float:left" />
	    </div>
		<div style="float:right;">
			<button id="submitRequest" class="btn btn-primary" 
				style="margin:5px 0;height:30px;width:50px"
				 onclick="submitRequest()">查询
			</button>
		</div>
	</div>
<div style="clear:both;height:20px"></div>

<hr>
<div style="text-align:center;width:window.screen.width;">
	<div style="margin-left:auto;margin-right:auto;" id="gaugeParent">
		<div id="g1Container" style="float:left;"></div>
		<div id="g2Container" style="float:left;"></div>
	</div>
</div>

    <!--机组的统计信息(表格)-->
<div style="margin:0">
<table id="table_id2" class="display cell-border" cellspacing="0" style="text-align:center">   
	<thead>
	    <tr>
	        <td colspan="4" style="text-align:center;font-size:18px;color:#000000">本厂机组统计信息  </td>
	    </tr>
	    <tr style="background-color:#30a4dd;color:#ffffff">   
	    	<td></td><td>#1机</td><td>#2机</td><td >电厂</td>   
	    </tr> 
	</thead>  
	    <tbody>   
	
	        <tr>   
	            <td>容量</td><td id="g1Volume">0</td><td id="g2Volume">0</td><td id="volume">0</td>   
	        </tr>   
	        <tr>   
	            <td>发电量</td><td id="g1Energy">0</td><td id="g2Energy">0</td><td id="energy">0</td>   
	        </tr> 
	        <tr>   
	            <td>平均有功</td><td id="g1Average">0</td><td id="g2Average">0</td><td id="average_power">0</td>   
	        </tr> 	                       
	        <tr>   
	            <td>利用小时</td><td id="g1TimeUse">0</td><td id="g2TimeUse">0</td><td id="timeUse">0</td>   
	        </tr> 	        
	    </tbody> 
</table>  
</div>
<div id="columnContainer" style=" height: 350px;width:95%"></div>
	<div style="clear:both;height:20px"></div>
        <script type="text/javascript">

			var resize_gauge = function()
			{
					container_speed=document.getElementById('g1Container');
					container_rpm=document.getElementById('g2Container');
					gaugeParent = $('#gaugeParent');
					//table_width=document.getElementById('table_id2').offsetWidth;
					table_width=document.body.clientWidth;
					wid=table_width/2;
					container_speed.style.width=wid-10+'px';
					container_rpm.style.width=wid-10+'px';
					
					container_speed.style.height=(container_speed.offsetWidth/9*7)+'px';
					container_rpm.style.height=(container_rpm.offsetWidth/9*7)+'px';
					gaugeParent.css("margin-left",(table_width-(wid-10)*2)/2);
					
			};
			
			window.onresize= resize_gauge;
			resize_gauge();
			

        </script>
        <div id="content_my" style="clear:both"></div>
        

	</body>
</html>
