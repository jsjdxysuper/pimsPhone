
<!DOCTYPE HTML>
<!-- <html manifest="generator.manifest">  -->
<html>
	<head>
    	<meta name="viewport" content="width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Highcharts Example</title>
  		<script type="text/javascript" src="./support/jquery-1.11.2.min.js"></script>
  		
         <script type="text/javascript" src="./support/bootstrap/js/bootstrap.min.js"></script>    
        <link href="./support/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
		<script type="text/javascript" src="./support/easyui/jquery.easyui.min.js"></script>  
        
		<script type="text/javascript" src="./support/datatable/media/js/jquery.dataTables.min.js"></script> 
        <link rel="stylesheet" type="text/css" href="./support/datatable/media/css/jquery.dataTables.min.css"/>
        <!--日期选择框-->
		<script src="./support/datepicker/js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css" />
        <link href="./support/datepicker/css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css" />
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css" />        
		
		
		
		
		<link href="./support/threeMainPage.css" rel="stylesheet" type="text/css" />
		<script src="./support/jquery.json.min.js" type="text/javascript"></script>
		
		<script type="text/javascript">
			var g1Chart;
			var g1Option;
			var g2Chart;
			var g2Option;
			var ajaxbg;
			var realTimeOption = null;
			
			
			$(function () {
	    		realTimeOption = {
				chart:{
					spacingLeft:0,
					renderTo: 'realTimeContainer'
				},
				colors:['#ff0000','#0000ff','#00ff00'],
				plotOptions:{
					line:{
						lineWidth:2,
						pointStart:0,
						marker:{
							enabled:false
						}
					}
				},
				exporting:{
					enabled:false
				},
				credits:{
					enabled:'false',
					text:''
				},
				labels:{
				},
	            title: {
	                text: '康平电厂机组有功',
	//                  x: -20, //center 
	            },
	            subtitle: {
	                text: '',
	                x: -20
	            },
	            xAxis: {
	//                  categories: ['1', '2', '3', '4', '5', '6',
	//                     '7', '8', '9', '10', '1', '12'], 
	            },
	            yAxis: {
	                title: {
	                    text: '有功 (兆瓦)',
	                },
	                plotLines: [{
	                    value: 0,
	                    width: 1,
	                    color: '#808080'
						
	                }],
					labels:{
	
					}
	            },
	            tooltip: {
	//                 valueSuffix: '万千瓦时',
	//                 headerFormat:"<span style=\"font-size: 10px\">$(\"#appDate\").value(),{point.key}</span><br/>",
	//                 pointFormat:"{series.name}:<b>aaa{point.y}</b>"
					formatter:function(){
						
						var s = '时间：'+timeStrArray[this.x]+""+'';
						s += '<br/>'+this.y+'兆瓦';
						return s;
					}
	            },
	            legend: {
	//                  layout: 'vertical',
	//                 align: 'right',
	// 				verticalAlign:'top',
	// 				floating:'true',
	// 				y:50,
	//                 borderWidth: 0, 
	            },
	            series: [
	             {
	                name: '今天',
	                data:  [10.0, 10.9, 12.5, 12.9, 16.2, 22.5, 22.2, 12.5, 12.3, 12.3, 13.9, 16.6,
	                		17.0, 15.9, 15.5, 15.5, 15.2, 23.5, 22.2, 15.5, 13.3, 14.3, 17.9, 15.6,
	                		16.0, 12.9, 14.5, 13.5, 11.2]
	            }, {
	                name: '昨天',
	                data:  [12.0, 13.9, 14.5, 14.9, 19.2, 26.5, 23.2, 18.5, 19.3, 19.3, 15.9, 12.6,
	                		19.0, 10.9, 14.5, 17.5, 19.2, 24.5, 24.2, 18.5, 19.3, 19.3, 15.9, 12.6,
	                		14.0, 15.9, 15.5, 16.5, 15.2]
	            }]
	        	};//全网线图
	        	chart = new Highcharts.Chart(realTimeOption);
    
    		});//function
			
			
			
			
			$(function () {
					
			    var gaugeOptions = {
				
				    chart: {
				        type: 'solidgauge'
				    },
				    
				    title: null,
				    
				    pane: {
				    	center: ['50%', '85%'],
				    	size: '130%',//中间表盘与pane的大小对比，数值越大，表盘就越大
				        startAngle: -90,
				        endAngle: 90,
			            background: {
			                backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
			                innerRadius: '60%',
			                outerRadius: '100%',
			                shape: 'arc'
			            }
				    },
			
				    tooltip: {
				    	enabled: false
				    },
				    credits:{
						enabled:'false',
						text:''
					}, 
				    // the value axis
				    yAxis: {
						stops: [
							[0.1, '#55BF3B'], // green
				        	[0.5, '#DDDF0D'], // yellow
				        	[0.9, '#DF5353'] // red
						],
						lineWidth: 0,
			            minorTickInterval: null,
			            tickPixelInterval: 400,
			            tickWidth: 0,
				        title: {
			                y: -40//标题的位置
				        },
			            labels: {
			                y: 10//表盘刻度位置
			
			            }   
				    },
			        
			        plotOptions: {
			            solidgauge: {
			                dataLabels: {
			                    y: 5,
			                    borderWidth: 0,
			                    useHTML: true
			                }
			            }
			        }
			    };
			    
			    // The speed gauge
			
			    
				//generator1对应的表盘的option
				g1Option = Highcharts.merge(gaugeOptions, {
					chart:{
				    	renderTo: 'g1Container'
				    },
			        yAxis: {
				        min: 0,
				        max: 100,
				        title: {
				            text: '康平电厂#1机'
				        }       
				    },
			
				    credits: {
				    	enabled: false
				    },
				
				    series: [{
				        name: 'rate',
				        data: [0],
				        dataLabels: {
				        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
			                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'gray') + '">{y}</span>' + 
			                   	'<span style="font-size:10px;color:gray">%</span></div>'
				        },
				        tooltip: {
				            valueSuffix: ' km/h'
				        }
				    }]
				
				});//g2Option
			
			
				//generator2对应的表盘的option
				g2Option = Highcharts.merge
				(gaugeOptions, 
				    {
				    	chart:{
				    		renderTo: 'g2Container'
				    	},
				        yAxis:{
				        	min: 0,
				        	max: 100,
					        title:{
					            text: '康平电厂#2机'
					        },    
					    },
					
					    series:[{
						        name: 'rate',
						        data: [0],
						        dataLabels:{
						        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
					                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'gray') + '">{y}</span>' + 
					                   	'<span style="font-size:10px;color:gray">%</span></div>'
						        },
						        tooltip:{
						            valueSuffix: ' revolutions/min'
						        }      
						    }
					    ]
					
					}
				);//g1Option			
			});//function

			//值间对比图
			$(function () {
				
			        
		        $('#container').highcharts({
		            chart: {
		                type: 'bar'
		            },
		            title: {
		                text: '60万机组值间对标'
		            },
		            subtitle: {
		                text: ''
		            },
		            xAxis: {
		                categories: ['白班', '前夜', '后夜'],
		                title: {
		                    text: null			
		                },
						labels: {
		                    overflow: 'justify'
		                }
		            },
		            yAxis: {
		                min: 0,
		                title: {
		                    text: '电量',
		                    align: 'middle'
		                },
		                labels: {
		                    overflow: 'justify'
		                }
		            },
		            tooltip: {
		                valueSuffix: ' 万千瓦时'
		            },
		            plotOptions: {
		                bar: {
		                    dataLabels: {
		                        enabled: true
		                    }
		                }
		            },
		            legend: {
		/*                 layout: 'vertical',
		                align: 'right',
		                verticalAlign: 'top',
		                x: -10,
		                y: 80,
		                floating: true,
		                borderWidth: 1,
		                backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor || '#FFFFFF'),
		                shadow: true */
		            },
		            credits: {
		                enabled: false
		            },
		            series: [{
		                name: '康平',
		                data: [107, 31, 635]
		            }, {
		                name: '庄河',
		                data: [133, 156, 947]
		            }, {
		                name: '营口',
		                data: [973, 514, 505]
		            }, {
		                name: '铁岭',
		                data: [373, 964, 205]
		            }, {
		                name: '清河',
		                data: [273, 414, 405]
		            }, {
		                name: '燕山湖',
		                data: [373, 814, 805]
		            }]
		        });//option
		    });//function
    
    submitRequest = function()
    {
    	var date = $("#appDate").val().trim();
    	var time_span = $("#menu_title").text().trim();
    	$.ajax({
    		url:"/pimsPhone/GeneratorServlet",
    		data:$.param({"date":date}),
    		type:"post",
    		beforeSend:function(){
    			ajaxbg.show(); 
    		}

    	})
    	.done(function(data,statusText){

			ajaxbg.hide();
    		var dataReceived = $.evalJSON(data);
    		
    		realTimeOption.series = dataReceived.realTimeData;
    		realTimeOption.series = realTimeOption.series.realtimeData;
    		chart = new Highcharts.Chart(realTimeOption);
    		
    		
    		$("#maxPower").text(dataReceived.max);
    		$("#minPower").text(dataReceived.min);
    		$("#average_power").text(dataReceived.average);
    		$("#energy").text(dataReceived.energy);
    		$("#timeUse").text(dataReceived.timeUse);
    		$("#recordCount").text("有功（兆瓦）电量（万千瓦时）,记录数："+dataReceived.recordCount+",时长："+dataReceived.timeOfHours+"小时");
    		$("#volume").text(GENERATORVOLUME*2);
    		
    		$("#g1Volume").text(GENERATORVOLUME);
    		$("#g1Energy").text(dataReceived.g1Energy);
    		$("#g1Max").text(dataReceived.g1Max);
    		$("#g1Min").text(dataReceived.g1Min);
    		$("#g1Average").text(dataReceived.g1Average);
    		$("#g1TimeUse").text(dataReceived.g1TimeUse);
    		
    		$("#g2Volume").text(GENERATORVOLUME);
    		$("#g2Energy").text(dataReceived.g2Energy);
    		$("#g2Max").text(dataReceived.g2Max);
    		$("#g2Min").text(dataReceived.g2Min);
    		$("#g2Average").text(dataReceived.g2Average);
    		$("#g2TimeUse").text(dataReceived.g2TimeUse);
    		
    		g1Option.series[0].data[0] = parseFloat((dataReceived.g1Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g1Option);
    		
    		g2Option.series[0].data[0] = parseFloat((dataReceived.g2Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g2Option);
    	})
    	.fail(function(){
    		alert("服务器响应出错");
    	});
    };


	$(document).ready(function() {
	
		//$('#table_id1').DataTable();
		if($("table").length > 0)
		{
			$("table").DataTable({
				paging:false,
				searching:false,
				info:false,
				ordering: false,
			});
		}
	
	
	});
	</script>
	
	<script type="text/javascript" src="./support/threeMainPage.js"></script>
	</head>
	<body>
<script src="./support/highcharts/js/highcharts.js"></script>
<script src="./support/highcharts/js/highcharts-more.js"></script>

<script src="./support/highcharts/js/modules/solid-gauge.js"></script> 
<script src="./support/ace/assets/js/spin.min.js"></script> 	



<div id="background" class="background" style="display: none; min-height: 100%;_height:100%;"></div> 
<div id="progressBar" class="progressBar" style="display: none;font-size: 12px;">数据加载中，请稍等...</div> 
<!--时间选择器-->
<div style="clear:both;height:10px"></div>
	<div style="margin-left:20px;margin-right:20px">
		<div style=";float:left">	
	        <label for="test_default" style="float:left;;width:80px">日&nbsp;&nbsp;&nbsp;&nbsp;期</label>
	        <input type="text" name="test_default" id="appDate" style="width:100px;float:left" />
	    </div>
		<div style="float:right;">
			<button id="submitRequest" class="btn btn-primary" 
				style="margin:5px 0;height:30px;width:50px"
				 onclick="submitRequest()">查询
			</button>
		</div>
	</div>
<div style="clear:both;height:20px"></div>


<div id="realTimeContainer" style=" height: auto;"></div>
<hr>
<div style="text-align:center;width:window.screen.width;">
	<div style="margin-left:auto;margin-right:auto;" id="gaugeParent">
		<div id="g1Container" style="float:left;"></div>
		<div id="g2Container" style="float:left;"></div>
	</div>
</div>

    <!--机组的统计信息(表格)-->
<div style="margin:0">
<table id="table_id2" class="display cell-border" cellspacing="0" style="text-align:center">   
	<thead>
	    <tr>
	        <td colspan="4" style="text-align:center;font-size:18px;color:#000000">本厂机组统计信息  </td>
	    </tr>
	    <tr style="background-color:#30a4dd;color:#ffffff">   
	    	<td></td><td>#1机</td><td>#2机</td><td >电厂</td>   
	    </tr> 
	</thead>  
	    <tbody>   
	
	        <tr>   
	            <td>容量</td><td id="g1Volume">0</td><td id="g2Volume">0</td><td id="volume">0</td>   
	        </tr>   
	        <tr>   
	            <td>发电量</td><td id="g1Energy">0</td><td id="g2Energy">0</td><td id="energy">0</td>   
	        </tr> 
	        <tr>   
	            <td>最小有功</td><td id="g1Min">0</td><td id="g2Min">0</td><td id="minPower">0</td>   
	        </tr> 
	        <tr>   
	            <td>最大有功</td><td id="g1Max">0</td><td id="g2Max">0</td><td id="maxPower">0</td>   
	        </tr> 
	        <tr>   
	            <td>平均有功</td><td id="g1Average">0</td><td id="g2Average">0</td><td id="average_power">0</td>   
	        </tr> 	                       
	        <tr>   
	            <td>利用小时</td><td id="g1TimeUse">0</td><td id="g2TimeUse">0</td><td id="timeUse">0</td>   
	        </tr> 	        
	    </tbody> 
</table>  
</div>

	<div style="clear:both;height:20px"></div>
		<div id="container" style=" height: 400px;"></div>
        <script type="text/javascript">

			var resize_gauge = function()
			{
					container_speed=document.getElementById('g1Container');
					container_rpm=document.getElementById('g2Container');
					gaugeParent = $('#gaugeParent');
					//table_width=document.getElementById('table_id2').offsetWidth;
					table_width=document.body.clientWidth;
					wid=table_width/2;
					container_speed.style.width=wid-10+'px';
					container_rpm.style.width=wid-10+'px';
					
					container_speed.style.height=(container_speed.offsetWidth/9*7)+'px';
					container_rpm.style.height=(container_rpm.offsetWidth/9*7)+'px';
					gaugeParent.css("margin-left",(table_width-(wid-10)*2)/2);
					
			};
			
			window.onresize= resize_gauge;
			resize_gauge();
			

        </script>
        <div id="content_my" style="clear:both"></div>
        

	</body>
</html>
