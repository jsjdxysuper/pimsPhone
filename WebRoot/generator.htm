
<!DOCTYPE HTML>
<html manifest="generator.manifest">
	<head>
    	<meta name="viewport" content="width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Highcharts Example</title>
  		<script type="text/javascript" src="./support/jquery-1.11.2.min.js"></script>
         <script type="text/javascript" src="./support/bootstrap/js/bootstrap.min.js"></script>    
        <link href="./support/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
		<script type="text/javascript" src="./support/easyui/jquery.easyui.min.js"></script>  
        
		<script type="text/javascript" src="./support/datatable/media/js/jquery.dataTables.min.js"></script> 
        <link rel="stylesheet" type="text/css" href="./support/datatable/media/css/jquery.dataTables.min.css"/>
        <!--日期选择框-->
		<script src="./support/datepicker/js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css" />
        <link href="./support/datepicker/css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css" />
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
        <script src="./support/datepicker/js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
        <link href="./support/datepicker/css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css" />        
		
		<link href="./support/threeMainPage.css" rel="stylesheet" type="text/css" />
		<script src="./support/jquery.json.min.js" type="text/javascript"></script>
		
		<script type="text/javascript">
			var g1Chart;
			var g1Option;
			var g2Chart;
			var g2Option;
			
$(function () {
	
    var gaugeOptions = {
	
	    chart: {
	        type: 'solidgauge'
	    },
	    
	    title: null,
	    
	    pane: {
	    	center: ['50%', '85%'],
	    	size: '140%',
	        startAngle: -90,
	        endAngle: 90,
            background: {
                backgroundColor: (Highcharts.theme && Highcharts.theme.background2) || '#EEE',
                innerRadius: '60%',
                outerRadius: '100%',
                shape: 'arc'
            }
	    },

	    tooltip: {
	    	enabled: false
	    },
	    credits:{
			enabled:'false',
			text:''
		}, 
	    // the value axis
	    yAxis: {
			stops: [
				[0.1, '#55BF3B'], // green
	        	[0.5, '#DDDF0D'], // yellow
	        	[0.9, '#DF5353'] // red
			],
			lineWidth: 0,
            minorTickInterval: null,
            tickPixelInterval: 400,
            tickWidth: 0,
	        title: {
                y: -40//标题的位置
	        },
            labels: {
                y: 10//表盘刻度位置

            }   
	    },
        
        plotOptions: {
            solidgauge: {
                dataLabels: {
                    y: 5,
                    borderWidth: 0,
                    useHTML: true
                }
            }
        }
    };
    
    // The speed gauge

    
	//generator1对应的表盘的option
	g1Option = Highcharts.merge(gaugeOptions, {
		chart:{
	    	renderTo: 'g1Container'
	    },
        yAxis: {
	        min: 0,
	        max: 100,
	        title: {
	            text: '机组名称#1'
	        }       
	    },

	    credits: {
	    	enabled: false
	    },
	
	    series: [{
	        name: 'Speed',
	        data: [0],
	        dataLabels: {
	        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span>' + 
                   	'<span style="font-size:10px;color:black">%</span></div>'
	        },
	        tooltip: {
	            valueSuffix: ' km/h'
	        }
	    }]
	
	});//g2Option


	//generator2对应的表盘的option
	g2Option = Highcharts.merge
	(gaugeOptions, 
	    {
	    	chart:{
	    		renderTo: 'g2Container'
	    	},
	        yAxis:{
	        	min: 0,
	        	max: 100,
		        title:{
		            text: '机组名称#2'
		        },    
		    },
		
		    series:[{
			        name: 'RPM',
			        data: [0],
			        dataLabels:{
			        	format: '<div style="text-align:center"><span style="font-size:14px;color:' + 
		                    ((Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black') + '">{y}</span>' + 
		                   	'<span style="font-size:10px;color:black">%</span></div>'
			        },
			        tooltip:{
			            valueSuffix: ' revolutions/min'
			        }      
			    }
		    ]
		
		}
	);//g1Option
	
	
});

//值间对比图
$(function () {
        $('#container').highcharts({
            chart: {
                type: 'bar'
            },
            title: {
                text: '60万机组对标(运行小时/电量)'
            },
            subtitle: {
                text: ''
            },
            xAxis: {
                categories: ['白班', '前夜', '后夜'],
                title: {
                    text: null			
                },
				labels: {
                    overflow: 'justify'
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: '电量/运行小时',
                    align: 'high'
                },
                labels: {
                    overflow: 'justify'
                }
            },
            tooltip: {
                valueSuffix: ' millions'
            },
            plotOptions: {
                bar: {
                    dataLabels: {
                        enabled: true
                    }
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -10,
                y: 80,
                floating: true,
                borderWidth: 1,
                backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor || '#FFFFFF'),
                shadow: true
            },
            credits: {
                enabled: false
            },
            series: [{
                name: '康平',
                data: [107, 31, 635]
            }, {
                name: '庄河',
                data: [133, 156, 947]
            }, {
                name: '营口',
                data: [973, 514, 505]
            }, {
                name: '铁岭',
                data: [373, 964, 205]
            }, {
                name: '清河',
                data: [273, 414, 405]
            }, {
                name: '燕山湖',
                data: [373, 814, 805]
            }]
        });
    });
    
    submitRequest = function()
    {
    	var date = $("#appDate").val().trim();
    	var time_span = $("#menu_title").text().trim();
    	$.ajax({
    		url:"http://192.168.137.1:8080/pimsPhone/GeneratorServlet",
    		data:$.param({"date":date,"time_span":time_span}),
    		type:"post"  		
    	})
    	.done(function(data,statusText){

    		var dataReceived = $.evalJSON(data);
    		$("#maxPower").text(dataReceived.max);
    		$("#minPower").text(dataReceived.min);
    		$("#average_power").text(dataReceived.average);
    		$("#energy").text(dataReceived.energy);
    		$("#timeUse").text(dataReceived.timeUse);
    		$("#recordCount").text("有功（兆瓦）电量（万千瓦时）,记录数："+dataReceived.recordCount+",时长："+dataReceived.timeOfHours+"小时");
    		
    		$("#g1Volume").text("机组容量:"+GENERATORVOLUME);
    		$("#g1Energy").text("发电量:"+dataReceived.g1Energy);
    		$("#g1Max").text("最大出力:"+dataReceived.g1Max);
    		$("#g1Min").text("最小出力:"+dataReceived.g1Min);
    		$("#g1Average").text("平均出力:"+dataReceived.g1Average);
    		
    		$("#g2Volume").text("机组容量:"+GENERATORVOLUME);
    		$("#g2Energy").text("发电量:"+dataReceived.g2Energy);
    		$("#g2Max").text("最大出力:"+dataReceived.g2Max);
    		$("#g2Min").text("最小出力:"+dataReceived.g2Min);
    		$("#g2Average").text("平均出力:"+dataReceived.g2Average);
    		
    		g1Option.series[0].data[0] = parseFloat((dataReceived.g1Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g1Option);
    		
    		g2Option.series[0].data[0] = parseFloat((dataReceived.g2Average/GENERATORVOLUME*100).toFixed(2));
    		chart = new Highcharts.Chart(g2Option);
    	})
    	.fail(function(){
    		alert("服务器响应出错");
    	});
    };

	</script>
	
	<script type="text/javascript" src="./support/threeMainPage.js"></script>
	</head>
	<body>
<script src="./support/highcharts/js/highcharts.js"></script>
<script src="./support/highcharts/js/highcharts-more.js"></script>

<script src="./support/highcharts/js/modules/solid-gauge.js"></script> 
	<!--时间选择器-->
<div style="" id="time_pick">
	<div style=";margin-left:10px;">	
        <label for="test_default" style="float:left;width:100px">日&nbsp;&nbsp;&nbsp;&nbsp;期</label>
        <input type="text" name="test_default" id="appDate" style="width:100px;float:left" />
    </div>
    <div style="clear:both;margin-left:10px;">

        <label for="form-field-select-1" style="float:left;width:100px">时间跨度</label>

        <!-- Single button -->
        <div class="btn-group">
          <button type="button" id="menu_title" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            实时 <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#">实时</a></li>
            <li class="divider"></li>
            <li><a href="#">年</a></li>
            <li><a href="#">月</a></li>
            
            <li><a href="#">日</a></li>
          </ul>
        </div>
														
	</div>
	<button id="submitRequest" onclick="submitRequest()">查询</button>
</div>
<hr style="clear:left">
    <!--机组的统计信息(表格)-->
    <div style="margin: 0px auto 20px auto;clear:left">
        <table id="table_id2" class="display cell-border" cellspacing="0" style="height:200px;text-align:center;font-size: 5px">   
        <thead>
            <tr>
                <td colspan="4" style="text-align:center">本厂机组统计信息  </td>
            </tr>
        </thead>  
            <tbody>   
                <tr>   
                    <td>容量</td><td>1200</td><td>最大出力</td><td id="maxPower">0</td>   
                </tr>   
                <tr>   
                    <td>平均出力</td><td id="average_power">0</td><td>最小出力</td><td id="minPower">0</td>   
                </tr>   
                <tr>   
                    <td>发电量</td><td id="energy">0</td><td>利用小时</td><td id="timeUse">0</td>   
                </tr>
            </tbody> 
            <tfoot><tr><td colspan="4" id="recordCount" style="text-align:right"></td></tr></tfoot>  
        </table>  
    </div>

    <!--机组实时信息(表盘)-->
    <div style=" height: 200px; margin: 0px auto 40px auto;text-align:center;">
        <div style="text-align:center;width:50%; float: left;">
            <div id="g1Container" style=""></div>
            <div style="margin:0 auto">机组运行方式</div>
            <div style="margin:0 auto;width: 50%;float:left;">
                <div style="" id="g1Volume">机组容量</div>
                <div style="" id="g1Energy">发电量</div>
                <div style="" id="g1Min">最小出力</div>
            </div>
            <div style="margin:0 auto;width: 50%;float:left;">                
                <div style="" id="g1Average">平均出力</div>
                <div style="" id="g1Max">最大出力</div>
                <div style="" id="g1RealtimePower">实时出力</div>
            </div>     
        </div>
        <div style="text-align:center;width: 50%;  float: left;">
            <div id="g2Container" style=""></div>
            <div style="margin:0 auto;text-align:center;width:100%">机组运行方式</div>
            <div style="margin:0 auto;width: 50%;float:left;">
                <div style="" id="g2Volume">机组容量</div>
                <div style="" id="g2Energy">发电量</div>
                <div style="" id="g2Min">最小出力</div>
            </div>
            <div style="margin:0 auto;width: 50%;float:left;">                
                <div style="" id="g2Average">平均出力</div>
                <div style="" id="g2Max">最大出力</div>
                <div style="" id="g2RealtimePower">实时出力</div>
            </div>   
        </div>        
        </div>
    


<hr>


		<div id="container" style=" height: 400px;"></div>
        <script type="text/javascript">

			var resize_gauge = function()
			{
					container_speed=document.getElementById('g1Container');
					container_rpm=document.getElementById('g2Container');
					//table_width=document.getElementById('table_id2').offsetWidth;
					table_width=window.screen.width;
					wid=table_width/2;
					container_speed.style.width='100%';
					container_rpm.style.width='100%';
					
					container_speed.style.height=(container_speed.offsetWidth/9*7)+'px';
					container_rpm.style.height=(container_rpm.offsetWidth/9*7)+'px';
			}
			
			window.onresize= resize_gauge;
			resize_gauge();
			

        </script>
        <div id="content_my" style="clear:both"></div>
	</body>
</html>
